version: '3.3'
services:
    db:
        image: mongo:4
        restart: unless-stopped

    app:
        build:
          context: .
        restart: unless-stopped
        environment:
          MONGODB_HOSTNAME: db
          JAEGER_HOSTNAME: jaeger
        depends_on:
         - db

    jaeger:
        image: jaegertracing/all-in-one:1.34
        environment:
          COLLECTOR_ZIPKIN_HOST_PORT: 9411
          QUERY_BASE_PATH: /jaeger

    web:
      image: nginx
      ports:
        - 80:80
      volumes:
        - ./nginx.conf:/etc/nginx/conf.d/default.conf
      depends_on:
        - app
        - jaeger
